{"version":3,"file":"findCandyGuardsByAuthority.mjs","sources":["../../../../../src/plugins/candyMachineModule/operations/findCandyGuardsByAuthority.ts"],"sourcesContent":["import { CandyGuard as MplCandyGuard } from '@metaplex-foundation/mpl-candy-guard';\nimport { PublicKey } from '@solana/web3.js';\nimport { CandyGuardsSettings, DefaultCandyGuardSettings } from '../guards';\nimport { CandyGuard, toCandyGuard } from '../models';\nimport { GpaBuilder } from '@/utils';\nimport { Operation, OperationHandler, OperationScope } from '@/types';\nimport { Metaplex } from '@/Metaplex';\n\n// -----------------\n// Operation\n// -----------------\n\nconst Key = 'FindCandyGuardsByAuthorityOperation' as const;\n\n/**\n * Find all Candy Guards matching by a given authority.\n *\n * ```ts\n * const candyGuards = await metaplex\n *   .candyMachines()\n *   .findAllCandyGuardsByAuthority({ authority: new PublicKey('...') });\n * ```\n *\n * @group Operations\n * @category Constructors\n */\nexport const findCandyGuardsByAuthorityOperation =\n  _findCandyGuardsByAuthorityOperation;\n// eslint-disable-next-line @typescript-eslint/naming-convention\nfunction _findCandyGuardsByAuthorityOperation<\n  T extends CandyGuardsSettings = DefaultCandyGuardSettings\n>(\n  input: FindCandyGuardsByAuthorityInput\n): FindCandyGuardsByAuthorityOperation<T> {\n  return { key: Key, input };\n}\n_findCandyGuardsByAuthorityOperation.key = Key;\n\n/**\n * @group Operations\n * @category Types\n */\nexport type FindCandyGuardsByAuthorityOperation<\n  T extends CandyGuardsSettings = DefaultCandyGuardSettings\n> = Operation<typeof Key, FindCandyGuardsByAuthorityInput, CandyGuard<T>[]>;\n\n/**\n * @group Operations\n * @category Inputs\n */\nexport type FindCandyGuardsByAuthorityInput = {\n  /** The authority to filter Candy Guards by. */\n  authority: PublicKey;\n};\n\n/**\n * @group Operations\n * @category Handlers\n */\nexport const findCandyGuardsByAuthorityOperationHandler: OperationHandler<FindCandyGuardsByAuthorityOperation> =\n  {\n    handle: async <T extends CandyGuardsSettings = DefaultCandyGuardSettings>(\n      operation: FindCandyGuardsByAuthorityOperation<T>,\n      metaplex: Metaplex,\n      scope: OperationScope\n    ) => {\n      const { authority } = operation.input;\n      const { programs, commitment } = scope;\n      const candyGuardProgram = metaplex.programs().getCandyGuard(programs);\n      const query = MplCandyGuard.gpaBuilder(\n        candyGuardProgram.address\n      ).addFilter('authority', authority);\n\n      const gpaBuilder = new GpaBuilder(metaplex, candyGuardProgram.address);\n      gpaBuilder.mergeConfig({ ...query.config, commitment });\n\n      return gpaBuilder.getAndMap((account) => toCandyGuard(account, metaplex));\n    },\n  };\n"],"names":["Key","findCandyGuardsByAuthorityOperation","_findCandyGuardsByAuthorityOperation","input","key","findCandyGuardsByAuthorityOperationHandler","handle","operation","metaplex","scope","authority","programs","commitment","candyGuardProgram","getCandyGuard","query","MplCandyGuard","gpaBuilder","address","addFilter","GpaBuilder","mergeConfig","config","getAndMap","account","toCandyGuard"],"mappings":";;;;AAQA;AACA;AACA;;AAEA,MAAMA,GAAG,GAAG,qCAA8C,CAAA;;AAE1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMC,mCAAmC,GAC9CC,qCAAoC;AACtC;AACA,SAASA,oCAAoC,CAG3CC,KAAsC,EACE;EACxC,OAAO;AAAEC,IAAAA,GAAG,EAAEJ,GAAG;AAAEG,IAAAA,KAAAA;GAAO,CAAA;AAC5B,CAAA;AACAD,oCAAoC,CAACE,GAAG,GAAGJ,GAAG,CAAA;;AAE9C;AACA;AACA;AACA;;AAcA;AACA;AACA;AACA;AACO,MAAMK,0CAAiG,GAC5G;AACEC,EAAAA,MAAM,EAAE,OACNC,SAAiD,EACjDC,QAAkB,EAClBC,KAAqB,KAClB;IACH,MAAM;AAAEC,MAAAA,SAAAA;KAAW,GAAGH,SAAS,CAACJ,KAAK,CAAA;IACrC,MAAM;MAAEQ,QAAQ;AAAEC,MAAAA,UAAAA;AAAW,KAAC,GAAGH,KAAK,CAAA;IACtC,MAAMI,iBAAiB,GAAGL,QAAQ,CAACG,QAAQ,EAAE,CAACG,aAAa,CAACH,QAAQ,CAAC,CAAA;AACrE,IAAA,MAAMI,KAAK,GAAGC,UAAa,CAACC,UAAU,CACpCJ,iBAAiB,CAACK,OAAO,CAC1B,CAACC,SAAS,CAAC,WAAW,EAAET,SAAS,CAAC,CAAA;IAEnC,MAAMO,UAAU,GAAG,IAAIG,UAAU,CAACZ,QAAQ,EAAEK,iBAAiB,CAACK,OAAO,CAAC,CAAA;IACtED,UAAU,CAACI,WAAW,CAAC;MAAE,GAAGN,KAAK,CAACO,MAAM;AAAEV,MAAAA,UAAAA;AAAW,KAAC,CAAC,CAAA;AAEvD,IAAA,OAAOK,UAAU,CAACM,SAAS,CAAEC,OAAO,IAAKC,YAAY,CAACD,OAAO,EAAEhB,QAAQ,CAAC,CAAC,CAAA;AAC3E,GAAA;AACF;;;;"}